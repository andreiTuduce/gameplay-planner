"use strict";exports.id=1539,exports.ids=[1539],exports.modules={71539:(t,e,a)=>{let o={roundTwoDecimal:function(t){return Math.round((t+Number.EPSILON)*100)/100},numberWithCommas:function(t){return t.replace(/\B(?=(\d{3})+(?!\d))/g,",")},roundThreeDecimal:function(t){return Math.round((t+Number.EPSILON)*1e3)/1e3},roundFiveDecimal:function(t){return Math.round((t+Number.EPSILON)*1e5)/1e5},roundInt:function(t){return Math.round((t+Number.EPSILON)*1)/1},calculateLogarithm:function(t,e){return Math.log(e)/Math.log(t)},calcPOW:function(t){return t.mantissa*Math.pow(10,t.exponent)},secondsToStringWithS:function(t){let e="",a=0,o=0,i=0,l=0;return(a=Math.floor(t/86400),o=Math.floor(t%86400/3600),i=Math.floor(t%3600/60),l=this.roundInt(t%86400%60),a==Number.POSITIVE_INFINITY||a==Number.NEGATIVE_INFINITY)?""+a:(60===l&&(l=0,i++),60===i&&(i=0,o++),24===o&&(o=0,a++),a>0&&(e+=`${a<10?"0"+a:a}d:`),o>0&&(e+=`${o<10?"0"+o:o}h:`),i>0&&(e+=`${i<10?"0"+i:i}m:`),l>0?e+=`${l<10?"0"+l:l}s`:e+="0s",e)},secondsToString:function(t){let e="",a=0,o=0,i=0;return(a=Math.floor(t/86400),o=Math.floor(t%86400/3600),60===(i=this.roundInt(t%3600/60))&&(i=0,o++),24===o&&(o=0,a++),a==Number.POSITIVE_INFINITY||a==Number.NEGATIVE_INFINITY)?""+a:(a>0&&(e+=`${a<10?"0"+a:a}d:`,0===o&&(e+="00h")),(o>0||0===o&&0===a)&&(e+=`${o<10?"0"+o:o}h`),0===a&&(e+=":",i>0?e+=`${i<10?"0"+i:i}m`:e+="0s"),e)},bonusColorMap:{1009:{color:"cyan"},1010:{color:"maroon"},1011:{color:"purple"},1012:{color:"yellow"},1013:{color:"red"},1014:{color:"blue"},1015:{color:"gray"},1016:{color:"green"}}};var i=a(23367);let l={createDecimal:function(t){return new i.Z(t.mantissa||0===t.mantissa?`${t.mantissa}e${t.exponent}`:t)},createDecimalString:function(t){return new i.Z(t)},multiplyDecimal:function(t,e){return(t=t.mantissa||0===t.mantissa?t:this.createDecimal(t)).times(e)},divideDecimal:function(t,e){return(t=t.mantissa||0===t.mantissa?t:this.createDecimal(t)).dividedBy(e)},addDecimal:function(t,e){return(t=t.mantissa||0===t.mantissa?t:this.createDecimal(t)).plus(e)},subtractDecimal:function(t,e){return(t=t.mantissa||0===t.mantissa?t:this.createDecimal(t)).minus(e)},logDecimal:function(t,e){return t=t.mantissa||0===t.mantissa?t:this.createDecimal(t),this.createDecimal(t.log(e))},pow:function(t,e){return(t=t.mantissa||0===t.mantissa?t:this.createDecimal(t)).pow(e)},min:function(t,e){return(t=t.mantissa||0===t.mantissa?t:this.createDecimal(t),e=e.mantissa||0===e.mantissa?e:this.createDecimal(e),t.greaterThan(e))?e:t},max:function(t,e){return(t=t.mantissa||0===t.mantissa?t:this.createDecimal(t),e=e.mantissa||0===e.mantissa?e:this.createDecimal(e),t.greaterThan(e))?t:e},round:function(t){return t=t.mantissa||0===t.mantissa?t:this.createDecimal(t),i.Z.round(t)}};var n={findMultipliersWithMinPercentage:function(t,e,a){let o=[],i=0;function backtrack(l,n,r){if(i++,l===e.length){let i=r.reduce((t,a,o)=>t+a*e[o],0);i>=a*t&&o.push([...r]);return}let s=Math.floor((t-n)/e[l]);for(let a=0;a<=s;a++)r[l]=a,n+a*e[l]<t&&backtrack(l+1,n+a*e[l],r)}return backtrack(0,0,[]),console.log(i),o},calcGrowthTime:function(t,e){let a=l.createDecimal(e.originalShopGrowingBonus);a=l.divideDecimal(a,1+.05*e.originalShopGrowingLevel),a=l.multiplyDecimal(a,1+.05*e.shopGrowingSpeed).toNumber();let o=Math.floor(t.TimeNeeded/t.prestigeBonus/a);return o<10?10:o},calcPlantHarvest:function(t,e){return o.roundInt((1+t.Rank)*Math.pow(1.05,t.Rank))*Math.pow(1.02,t.prestige)*e.manualHarvestBonus},calcShopProdBonus:function(t,e){return e=e||0===e?e:t.FarmingShopPlantTotalProduction,l.pow(1.25,e)},calcProdOutput:function(t,e){let a=t.totalMade,o=e.shopProdBonus,i=t.prestige,n=l.createDecimal(e.originalShopProdBonus);n=l.divideDecimal(n,this.calcShopProdBonus(null,e.originalShopProdLevel)),n=l.multiplyDecimal(o,n);let r=t.futureMult,s=l.multiplyDecimal(l.multiplyDecimal(l.multiplyDecimal(a,r),n),l.createDecimal(Math.pow(1.02,i)));return 1===t.ID&&(s=l.multiplyDecimal(s,e.hpBonus),s=l.pow(s,e.hpBonusExponent)),s},calcFryOutput:function(t,e){if(!t||t.lessThan(1e16))return 0;let a=0,o=e.timePassed?e.timePassed:0;o>1800&&(a=o<86400?o/86400:1+(o-86400)/(172800+.5*(o-86400)));let i=l.logDecimal(t,10),n=l.subtractDecimal(i,15.75),r=i;r=r.lessThan(31)?r:31;let s=l.subtractDecimal(36,r),c=l.subtractDecimal(i,16),u=l.pow(1.15,c),m=l.multiplyDecimal(n,s),p=l.multiplyDecimal(m,u),d=l.createDecimal(e.fryBonus),h=l.multiplyDecimal(p,d),P=l.multiplyDecimal(h,a);return l.pow(P,e.fryBonusExponent)},calcCarryOverEXP_OLD:function({plant:t,numAutos:e,expTick:a}){let o=0,i=1;if(e>1){let l=a/e,n=Math.ceil((t.reqExp-t.curExp)/l);if(e>n){o=(e-n)*l;let a=10+5*(t.Rank+i)*Math.pow(1.05,t.Rank+i);for(;o>a;)o-=a,i++,a=10+5*(t.Rank+i)*Math.pow(1.05,t.Rank+i)}else o=0}else o=0;let l=10+5*(t.Rank+i)*Math.pow(1.05,t.Rank+i);return{leftOver:o,numLevels:i,reqExp:l}},calcCarryOverEXP:function({plant:t,numAutos:e,expTick:a}){let o=0,i=t.curExp+e*a,l=10+5*(t.Rank+o)*Math.pow(1.05,t.Rank+o);for(;i>=l;)i-=l,o++,l=10+5*(t.Rank+o)*Math.pow(1.05,t.Rank+o);return{leftOver:i,numLevels:o,reqExp:l}},calcEXPBonus:function(t){let e=t.originalRankLevelBonus,a=t.originalShopRankLevel,o=t.shopRankLevel,i=t.originalPotionRank,n=t.potionRank,r=l.createDecimal(e);return r=l.divideDecimal(r,1+.1*a),r=l.divideDecimal(r,i>0?1.5:1),r=l.multiplyDecimal(r,1+.1*o),r=(r=l.multiplyDecimal(r,n)).toNumber()},futureMultBD:function(t,e){return l.pow(1+.05*(1+.02*e.manualHarvestFormula),l.logDecimal(t.created,1.25))},calcFutureMult:function(t,e){let a=!1===e.string?t:JSON.parse(JSON.stringify(t)),o=!1===e.string?e:JSON.parse(JSON.stringify(e)),i=o.time,n=o.numAuto||o?.numAuto===0?o.numAuto:1,r=this.calcEXPBonus(o),s=a.prestigeBonus*r;if(a.growthTime=this.calcGrowthTime(a,o),0===n){let t=this.calcProdOutput(a,o);return a.production=t,a}for(;i>0;){a.timeToLevel=this.calcTimeTillLevel(a,o);let t=0,e=!1;a.timeToLevel>i?t=i:(t=a.timeToLevel,e=!0),i-=t,a.elapsedTime+=t;let r=0;if(a.elapsedTime>=a.growthTime){r=Math.floor(a.elapsedTime/a.growthTime);let t=a.perHarvest*r*n;if(a.created=l.addDecimal(a.created,t),a.totalMade=l.addDecimal(a.totalMade,t),a.futureMult=this.futureMultBD(a,o),e){let t=this.calcCarryOverEXP({plant:a,expTick:s*r,numAutos:n});a.curExp=t.leftOver,a.Rank+=t.numLevels,a.perHarvest=this.calcPlantHarvest(a,o),a.reqExp=t.reqExp}else{let t=r*s*n,e=a.curExp+t;a.curExp=e}a.elapsedTime=a.elapsedTime%a.growthTime}}let c=this.calcProdOutput(a,o);return a.production=c,a},calcTimeTillLevel:function(t,e){let a=e.numAuto||e?.numAuto===0?e.numAuto:1;if(0===a)return 1/0;let o=t.reqExp-t.curExp,i=this.calcEXPBonus(e);return Math.ceil(o/(t.prestigeBonus*i*a))*t.growthTime-t.elapsedTime},getNextShopCosts:function(t){let e=1,a=t.FarmingShopPlantTotalProduction||0===t.FarmingShopPlantTotalProduction?t.FarmingShopPlantTotalProduction:t.shopProdLevel,o=1,i=t.FarmingShopPlantGrowingSpeed||0===t.FarmingShopPlantGrowingSpeed?t.FarmingShopPlantGrowingSpeed:t.shopGrowingSpeed,n=t.FarmingShopPlantRankExpEarned||0===t.FarmingShopPlantRankExpEarned?t.FarmingShopPlantRankExpEarned:t.shopRankLevel,r=l.pow(1.05,a-50),s=l.multiplyDecimal(100,r),c=l.pow(s,a),u=l.multiplyDecimal(1e8,c);return{prodCost:e=a>50?u:l.multiplyDecimal(1e8,l.pow(100,a)),growthCost:l.multiplyDecimal(l.pow(500,i),1e10),expCost:l.multiplyDecimal(l.pow(250,n),1e15)}},calcMaxPrestige:function(t){let e=t.prestige,a=0,o=!0;for(;o;){let i=10*Math.pow(2,e),l=a+i;t.created.greaterThanOrEqualTo(l)?(e++,a+=i):o=!1}return e-t.prestige},calcTimeTillPrestige:function(t,e){let a=JSON.parse(JSON.stringify(t));this.resetPlantBD(a);let o=JSON.parse(JSON.stringify(e));this.resetModifiersBD(o);let i=o.numAuto||o?.numAuto===0?o.numAuto:1,n=!1,r=0,s=0,c=this.calcEXPBonus(o),u=a.prestigeBonus*c;for(;!n;){let t=this.calcTimeTillLevel(a,o),e=10*Math.pow(2,a.prestige),c=s+e,m=l.subtractDecimal(c,a.created),p=l.multiplyDecimal(l.divideDecimal(m,a.perHarvest*i).ceil(),a.growthTime).ceil().toNumber();if(0===i&&m.greaterThan(0))n=!0,r=1/0;else if(p<=0)n=!0,r<=0&&(a.prestige++,n=!1,s+=e);else if(p>t){a.elapsedTime+=t;let e=Math.floor(a.elapsedTime/a.growthTime);a.created=l.addDecimal(a.created,e*a.perHarvest*i),a.totalMade=l.addDecimal(a.totalMade,e*a.perHarvest*i);let n=this.calcCarryOverEXP({plant:a,numAutos:i,expTick:u*e});a.Rank+=n.numLevels,a.curExp=n.leftOver,a.reqExp=n.reqExp,a.perHarvest=this.calcPlantHarvest(a,o),r+=t,a.elapsedTime=a.elapsedTime%a.growthTime}else{n=!0,a.elapsedTime+=p;let t=Math.floor(a.elapsedTime/a.growthTime);a.created=l.addDecimal(a.created,t*a.perHarvest*i),a.totalMade=l.addDecimal(a.totalMade,t*a.perHarvest*i),r+=p,a.elapsedTime=a.elapsedTime%a.growthTime}}return{remainingTime:r,prestige:a.prestige,prestiged:n}},resetPlantBD:function(t){t.totalMade=t?.totalMade?.mantissa||t?.totalMade?.mantissa===0?t.totalMade:l.createDecimal(t.totalMade),t.created=t?.created?.mantissa||t?.created?.mantissa===0?t.created:l.createDecimal(t.created),t.production=t?.production?.mantissa||t?.production?.mantissa===0?t.production:l.createDecimal(t.production),t.futureMult=l.createDecimal(t.futureMult)},resetModifiersBD:function(t){t.shopProdBonus=t?.shopProdBonus?.mantissa||t?.shopProdBonus?.mantissa===0?t.shopProdBonus:l.createDecimal(t.shopProdBonus),t.hpBonus=t?.hpBonus?.mantissa||t?.hpBonus?.mantissa===0?t.hpBonus:l.createDecimal(t.hpBonus),t.curPotatoes=t?.curPotatoes?.mantissa||t?.curPotatoes.mantissa===0?t.curPotatoes:l.createDecimal(t.curPotatoes),t.totalPotatoes=t?.totalPotatoes?.mantissa||t?.totalPotatoes?.mantissa===0?t.totalPotatoes:l.createDecimal(t.totalPotatoes)},calcHPProd:function(t,e){let a=JSON.parse(JSON.stringify(t));for(let t=0;t<a.length;t++)this.resetPlantBD(a[t]);let i=JSON.parse(JSON.stringify(e));this.resetModifiersBD(i),i.nextCosts.prodCost=l.createDecimal(i.nextCosts.prodCost),i.nextCosts.growthCost=l.createDecimal(i.nextCosts.growthCost),i.nextCosts.expCost=l.createDecimal(i.nextCosts.expCost);let r=i.numAutos,s=i.time,c=i.startTime?i.startTime:0,u=i.runningTime?i.runningTime:0,m=i.maxSteps?i.maxSteps:100,p=i.tickStart?i.tickStart:0,d=i.tickRate?i.tickRate:60,h=i.dataPointThreshold?i.dataPointThreshold:s/d<m?1:o.roundInt(s/d/m),P=[],g=[],f=i.totalPotatoes,D=i.curPotatoes,T=Array(a.length).fill(0);for(let t=0;t<a.length;t++)T[t]=a[t].production;let S=0,M=!1,v=1;for(d>2&&(v=.95),v=.95;S<s/d||M;S++){let t=0;for(let e=a.length-1;e>=0;e--){let o=a[e],n=e===a.length-1?0:d>1?l.multiplyDecimal(l.addDecimal(T[e+1],a[e+1].production),.45*d*v):l.multiplyDecimal(a[e+1].production,d);o.totalMade=l.addDecimal(o.totalMade,n),1===(o=this.calcFutureMult(o,{...i,time:d,numAuto:r[e],string:!1})).ID&&(t=T[e]),T[e]=o.production}i.timePassed+=d,i.potionRank>1&&!i.forceRankPotion&&(i.potionRankTime-=d,i.potionRankTime<0&&(i.potionRank=1));let e=o.roundInt(S*d+c),m=d>1?l.multiplyDecimal(l.addDecimal(t,a[0].production),.45*d*v):a[0].production;if(f=l.addDecimal(f,m),D=l.addDecimal(D,m),i.autoBuyPBC){let t=!1,e=!0;for(;e;)if(e=!1,!0===D.greaterThanOrEqualTo(i.nextCosts.prodCost)&&(D=l.subtractDecimal(D,i.nextCosts.prodCost),i.shopProdLevel++,i.shopProdBonus=this.calcShopProdBonus(i,i.shopProdLevel),t=!0,e=!0),!0===D.greaterThanOrEqualTo(i.nextCosts.growthCost)&&(D=l.subtractDecimal(D,i.nextCosts.growthCost),i.shopGrowingSpeed++,t=!0,e=!0),!0===D.greaterThanOrEqualTo(i.nextCosts.expCost)&&(D=l.subtractDecimal(D,i.nextCosts.expCost),i.shopRankLevel++,i.shopRankEXP=1+.1*i.shopRankLevel,t=!0,e=!0),t){let t=this.getNextShopCosts(i);i.nextCosts=t}}if(S%h==0&&e>=p&&e<=s+u&&(P.push({time:e,production:f}),g.push({time:e,fries:l.multiplyDecimal(n.calcFryOutput(f,i),1.05)})),!i.skipFinal){if(M&&e>=s+u)break;!M&&e<s+u&&(M=!0)}}if(S>0&&!i.skipFinal){let t=o.roundInt(S*d+c);if(i.passedTime=S*d+c,0===P.length)P.push({time:t,production:f}),g.push({time:t,fries:l.multiplyDecimal(n.calcFryOutput(f,i),1.05)});else if(P[P.length-1].production!==f&&t>s+u){let e=t-P[P.length-1].time,a=l.divideDecimal(l.subtractDecimal(f,P[P.length-1].production),e),o=s+u-P[P.length-1].time,r=l.addDecimal(P[P.length-1].production,l.multiplyDecimal(a,o)),c={time:P[P.length-1].time+o,production:r};P.push(c),g.push({time:P[P.length-1].time+o,fries:l.multiplyDecimal(n.calcFryOutput(f,i),1.05)}),f=r}}return{totalPotatoes:f,potatoeProduction:a[0].production,plants:a,nextCosts:i.nextCosts,dataPointsPotatoes:P,dataPointsFries:g,finalModifiers:i}},calcStepHPProd:function(t,e){let a=JSON.parse(JSON.stringify(t));for(let t=0;t<a.length;t++)this.resetPlantBD(a[t]);let i=JSON.parse(JSON.stringify(e));this.resetModifiersBD(i);let l=i.steps,n=-1,r=[],s=[],c=0,u=i.maxSteps?i.maxSteps:100,m=i.tickRate?i.tickRate:60,p=e.time/m<u?1:o.roundInt(e.time/m/u);for(let t=0;t<l.length;t++)0!==l[t].time&&((i=(n=this.calcHPProd(a,{...i,numAutos:l[t].autos,time:l[t].time,dataPointThreshold:p,startTime:r.length>0?r[r.length-1].time:0,runningTime:c,skipFinal:t<l.length-1,tickStart:r.length>0?r[r.length-1].time+p*m:0})).finalModifiers).totalPotatoes=n.totalPotatoes,a=n.plants,r=r.concat(n.dataPointsPotatoes),s=s.concat(n.dataPointsFries),l[t].obj={text:`P${l.length-t} for ${l[t].time}`,numAutos:l[t].autos,time:l[t].time},c+=l[t].time);return -1===n?(n={}).dataPointsPotatoes=r:n.dataPointsPotatoes=r,n.dataPointsFries=s,n.steps=l,n},calcAssemblyHP:function(t){let e=1;return t?.AssemblerCollection[0].BonusList[0].StartingLevel<=t?.AssemblerCollection[0].Level&&(e=Math.pow(1+t?.AssemblerCollection[0].BonusList[0].Gain,t?.AssemblerCollection[0].Level-t?.AssemblerCollection[0].BonusList[0].StartingLevel)),e},calcAssembly:function(t,e,a){let o=1;return t?.AssemblerCollection[e].BonusList[a].StartingLevel<=t?.AssemblerCollection[e].Level&&(o=Math.pow(1+t?.AssemblerCollection[e].BonusList[a].Gain,Math.max(0,t.AssemblerCollection[e].Level-(t.AssemblerCollection[e].BonusList[a].StartingLevel-1)))),o},calcAssemblyLine:function(t,e){let a=1;return t.StartingLevel<=e&&(a=Math.pow(1+t.Gain,Math.max(0,e-(t.StartingLevel-1)))),a},calcAssemblyCost:function(t,e){l.createDecimal(-1);let a=l.createDecimal(e.AssemblyCostReductionBonus),o=e.AssemblerCollection[t],i=l.createDecimal(o.BaseCost),n=l.addDecimal(i,l.multiplyDecimal(i,o.Level)),r=1+o.CostExpo+o.CostExpo*o.Level*.02,s=l.createDecimal(r),c=l.pow(s,o.Level);return l.divideDecimal(l.multiplyDecimal(n,c),a)},calcProteinPerSecond:function(t){let e=l.createDecimal(t.ProteinBonus),a=1+.03*((t.FarmingShopUniqueProtein[18]?t.FarmingShopUniqueProtein[18]:0)+(t.FarmingShopUniqueProtein[19]?t.FarmingShopUniqueProtein[19]:0)+(t.FarmingShopUniqueProtein[20]?t.FarmingShopUniqueProtein[20]:0)+(t.FarmingShopUniqueProtein[21]?t.FarmingShopUniqueProtein[21]:0)),o=l.createDecimal(t.FrenchFriesTotal),i=l.createDecimal(1);if(o.greaterThan(1e10)){let t=l.logDecimal(o,5);t=l.subtractDecimal(t,13.48);let n=l.logDecimal(o,10);n=l.subtractDecimal(n,8),i=l.multiplyDecimal(l.multiplyDecimal(t,l.pow(1.1,n)),e),i=l.pow(i,a)}return i},calcContagionBonus:function(t,e){let a=1;return t.GrasshopperCollection[e].Locked>0&&(a*=Math.pow(1+.01*o.calcPOW(t.GrasshopperCollection[e].BaseBonus),o.calcPOW(t.GrasshopperCollection[e].Level))),a},calcExpeditionHP:function(t){let e=1;if(t.ExpeditionsCollection[16].Locked>0){let a=t.ExpeditionsCollection[16];e=Math.pow(1+a.BonusPower,a.Room-1)}return e},calcUniqueHPBonus:function(t){let e=1;for(let a=0;a<t.FarmingShopUniqueHealthy.length;a++)e*=t.FarmingShopUniqueHealthy[a]+1;return e},calcFriesHPBonus:function(t){return 1*(1+o.calcPOW(t.FrenchFriesTotal)*((.01*t.FarmingShopFriesHealthyBonus+.1)*this.calcContagionBonus(t,5)))},calcPetHPBonus:function(t){let e=1,a=t.EquipedPetID,i=t.PetsCollection,l={};for(let t=0;t<a.length;t++)a[t]>0&&(l[a[t]]=!0);for(let t=0;t<i.length;t++){let a=i[t];if(a.ID in l)for(let t=0;t<a.BonusList.length;t++){let i=a.BonusList[t];23===i.ID&&(e+=.5*((Math.pow(1+i.Gain,a.Level)-1+Math.max(0,(.005*o.calculateLogarithm(1.0125,a.Level+1)-1)*.5))*(1+.005*o.calculateLogarithm(1.075,a.Rank+1))))}}return e}};self.onmessage=({data:{data:t,id:e,data1:a}})=>{try{let e=t.finalPlants;for(let t=0;t<e.length;t++){let a=e[t];a.created=l.createDecimal(a.created),a.totalMade=l.createDecimal(a.totalMade),a.production=l.createDecimal(a.production)}let a=t.modifiers;a.shopProdBonus=l.createDecimal(a.shopProdBonus),a.hpBonus=l.createDecimal(a.hpBonus),a.curPotatoes=l.createDecimal(a.curPotatoes),a.totalPotatoes=l.createDecimal(a.totalPotatoes);let i=t.mode,r=t.time,s=t.numSimulatedAutos?t.numSimulatedAutos:1,c=t.combinations,u=l.createDecimal(0),m={},p=l.createDecimal(0),d={},h=0,P={potatoeProduction:0},g=0,f={potatoeProduction:0},D={...a,time:3600*r},T=[],S=[],M=0,v=t.end-t.start;for(let a=t.start;a<=t.end;a++){let l,B;v--,M++;let w=c[a];switch(D.numAutos=w,i){case"afk":default:l=n.calcHPProd(e,D);break;case"carlo":l=n.calcStepHPProd(e,{...D,steps:w});break;case"step":let C=[],b=0,y=0,x=0;for(let e=0;e<w.length;e++)w[e]>0&&(y++,x+=w[e]*t.baseTimers[e]);let L=3600*r-x;for(let a=0;a<t.baseTimers.length;a++){w[a]>0&&b++;let i=Array(t.baseTimers.length).fill(0);i[a]=s,i.reverse();let l=w[a]*t.baseTimers[a];if(b===y&&w[a]>0)l+=L;else if(w[a]>0){let t=e[e.length-1-a],o=l%t.growthTime;if(o<=.5*t.growthTime)l-=o,L+=o;else{let e=t.growthTime-o;L>=e&&(l+=e,L-=e)}}C.push({time:o.roundInt(l),autos:i})}l=n.calcStepHPProd(e,{...D,steps:C})}let k=0,E=0;for(let t=0;t<l.plants.length;t++){let e=n.calcMaxPrestige(l.plants[t]);k+=e,E+=Math.pow(1.02,l.plants[t].prestige+e)-Math.pow(1.02,l.plants[t].prestige),l.plants[t].picIncrease=e}!0===l.totalPotatoes.greaterThanOrEqualTo(u)&&(u=l.totalPotatoes,m={combo:w,result:l,plants:l.plants},T.unshift({data:l.dataPointsPotatoes,result:u}),T.length>10&&T.pop(),S.unshift({data:l.dataPointsFries,result:u}),S.length>10&&S.pop()),!0===l.potatoeProduction.greaterThanOrEqualTo(p)&&(p=l.potatoeProduction,d={combo:w,result:l,plants:l.plants}),k>h?(B={combo:w,result:l,plants:l.plants,potatoeProduction:l.potatoeProduction,picGain:k,picStats:{picLevel:k,picPercent:E}},h=k,P=B):k===h&&l.potatoeProduction.greaterThanOrEqualTo(P.potatoeProduction)&&(B={combo:w,result:l,plants:l.plants,potatoeProduction:l.potatoeProduction,picGain:k,picStats:{picLevel:k,picPercent:E}},h=k,P=B),E>g?(B={combo:w,result:l,plants:l.plants,potatoeProduction:l.potatoeProduction,picGain:E,picStats:{picLevel:k,picPercent:E}},g=E,f=B):E===g&&l.potatoeProduction.greaterThanOrEqualTo(f.potatoeProduction)&&(B={combo:w,result:l,plants:l.plants,potatoeProduction:l.potatoeProduction,picGain:E,picStats:{picLevel:k,picPercent:E}},g=E,f=B),M%100==0&&self.postMessage({update:!0,temp:B,updateAmount:100})}self.postMessage({update:!0,updateAmount:v}),self.postMessage({success:!0,totalPotCombo:m,bestProdCombo:d,bestPicCombo:P,bestPICPercCombo:f,top10DataPointsPotatoes:T,top10DataPointsFries:S})}catch(t){console.log(t)}}}};